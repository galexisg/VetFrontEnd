@page "/dispensas/agregar"
@using Veterinaria.MAUIApp.Models
@using Veterinaria.MAUIApp.Services
@inject DispensaService DispensaService
@inject NavigationManager Navigation

<h3>Crear nueva dispensa</h3>

<EditForm Model="modelo" OnValidSubmit="Guardar">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-2">
        <label>Prescripción:</label>
        <InputNumber @bind-Value="modelo.PrescripcionDetalleId" class="form-control" />
    </div>
    <div class="mb-2">
        <label>Almacén:</label>
        <InputNumber @bind-Value="modelo.AlmacenId" class="form-control" />
    </div>
    <div class="mb-2">
        <label>Lote:</label>
        <InputNumber @bind-Value="modelo.LoteId" class="form-control" />
    </div>
    <div class="mb-2">
        <label>Cantidad:</label>
        <InputNumber @bind-Value="modelo.Cantidad" class="form-control" />
    </div>
    <div class="mb-2">
        <label>Fecha:</label>
        <InputDate @bind-Value="modelo.Fecha" class="form-control" />
    </div>
    <div class="mb-2">
        <label>Usuario:</label>
        <InputNumber @bind-Value="modelo.UsuarioId" class="form-control" />
    </div>

    <button type="submit" class="btn btn-success">Guardar</button>
    <button type="button" class="btn btn-secondary" @onclick="Cancelar">Cancelar</button>
</EditForm>

@code {
    private Dispensa_Guardar modelo = new() { Fecha = DateTime.Today };

    private async Task Guardar()
    {
        var resultado = await DispensaService.CreateAsync(modelo);
        if (resultado is not null)
        {
            Navigation.NavigateTo("/dispensas");
        }
    }

    private void Cancelar() => Navigation.NavigateTo("/dispensas");
}